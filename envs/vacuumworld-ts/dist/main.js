(()=>{"use strict";class e{actorID;constructor(t){this.actorID=e.validateActorID(t)}static validateActorID(e){if(null==e)throw new Error("The actor ID cannot be null or undefined.");return e}getActorID(){return this.actorID}getEffort(){return d.getEffort(typeof this)}}class t extends e{content;recipientsIDs;constructor(e,o,i){super(e),this.content=t.validateContent(o),this.recipientsIDs=null==i?[]:i}static validateContent(e){if(null==e)throw new Error("The content cannot be null or undefined.");return e}getContent(){return this.content}getRecipientsIDs(){return this.recipientsIDs}getEffort(){return 0===this.recipientsIDs.length?d.getEffort(typeof o):super.getEffort()}}class o extends t{constructor(e,t){super(e,t)}}class i extends e{constructor(e){super(e)}}class n extends i{constructor(e){super(e)}}class l extends i{colour;constructor(e,t){super(e),this.colour=l.validateColour(t)}getColour(){return this.colour}static validateColour(e){if(null==e)throw new Error("The dirt colour cannot be null or undefined.");return e}}class s extends i{constructor(e){super(e)}}class a extends i{constructor(e){super(e)}}class r extends t{constructor(e,t,o){super(e,t,o)}}class c extends i{turningDirection;constructor(e,t){super(e),this.turningDirection=c.validateTurningDirection(t)}static validateTurningDirection(e){if(null==e)throw new Error("The turning direction cannot be null or undefined.");return e}getTurningDirection(){return this.turningDirection}}class d{constructor(){}static ACTION_EFFORTS=d.loadDefaultActionEfforts();static loadDefaultActionEfforts(){const e=new Map;return e.set(typeof s,1n),e.set(typeof a,1n),e.set(typeof c,1n),e.set(typeof n,1n),e.set(typeof l,1n),e.set(typeof r,1n),e.set(typeof o,1n),e}static getEffort(e){return d.ACTION_EFFORTS.has(e)?d.ACTION_EFFORTS.get(e):1n}}(new class{speed;autoplay;stateToLoad;tooltipsActive;maxNumberOfCycles;efforts;teleora;constructor(){this.setDefaultOptions()}setDefaultOptions(){this.speed=0,this.autoplay=!1,this.stateToLoad=void 0,this.tooltipsActive=!0,this.maxNumberOfCycles=void 0,this.efforts=new Map,this.teleora=void 0}run(){this.createSkeletonView(),document.getElementById("initial_view_div").appendChild(this.loadStartMenu()),document.getElementById("initial_view_div").removeAttribute("hidden"),document.getElementById("initial_view_buttons_div").appendChild(this.createButton("Start","start_button",["initial_buttons"],this.startSimulation.bind(this))),document.getElementById("initial_view_buttons_div").appendChild(this.createButton("Options","options_button",["initial_buttons"],this.setOptions.bind(this))),document.getElementById("initial_view_buttons_div").appendChild(this.createButton("Guide","guide_button",["initial_buttons"],this.openWiki.bind(this))),document.getElementById("initial_view_buttons_div").removeAttribute("hidden")}createSkeletonView(){this.setTitle("VacuumWorld"),this.createPlatformDiv()}setTitle(e){null!=e&&""!==e&&(document.title=e)}createPlatformDiv(){let e=document.createElement("div");e.id="platform_div",e.classList.add("center-aligned"),document.getElementById("container_div").appendChild(e),this.createHiddenCenterAlignedDiv("platform_div","initial_view_div"),this.createHiddenCenterAlignedDiv("platform_div","initial_view_buttons_div"),this.createHiddenCenterAlignedDiv("platform_div","options_dialog_div"),this.createHiddenCenterAlignedDiv("platform_div","grid_div"),this.createHiddenCenterAlignedDiv("platform_div","draggable_bodies_div"),this.createHiddenCenterAlignedDiv("platform_div","simulation_controls_div")}createHiddenCenterAlignedDiv(e,t){let o=document.createElement("div");o.id=t,o.classList.add("center-aligned"),o.hidden=!0,document.getElementById(e).appendChild(o)}createOptionsDialog(){let e=document.createElement("dialog");e.id="options_dialog",document.getElementById("options_dialog_div").appendChild(e),this.createDivWithLabel("options_dialog","speed_selector_div","speed_selector","Speed"),this.createDivWithLabel("options_dialog","autoplay_selector_div","autoplay_selector","Autoplay"),this.createDivWithLabel("options_dialog","state_to_load_selector_div","state_to_load_selector","State"),this.createDivWithLabel("options_dialog","tooltips_selector_div","tooltips_selector","Tooltips"),this.createDivWithLabel("options_dialog","max_number_of_cycles_selector_div","max_number_of_cycles_selector","Cycles"),this.createDivWithLabel("options_dialog","efforts_selector_div","efforts_selector","Efforts"),this.createDivWithLabel("options_dialog","teleora_selector_div","teleora_selector","Teleora mind core"),this.createSpeedSelectorSelectElement(),this.createButtonWithoutCallback("options_dialog","options_dialog_ok_button","OK"),this.createButtonWithoutCallback("options_dialog","options_dialog_cancel_button","Cancel")}createDivWithLabel(e,t,o,i){let n=document.createElement("div");n.id=t,document.getElementById(e).appendChild(n),this.createAndAppendLabel(t,o,i)}createAndAppendLabel(e,t,o){let i=document.createElement("label");i.htmlFor=t,i.innerText=o,document.getElementById(e).appendChild(i)}createSpeedSelectorSelectElement(){let e=document.createElement("select");e.id="speed_values",document.getElementById("speed_selector_div").appendChild(e)}createButtonWithoutCallback(e,t,o){let i=document.createElement("button");i.id=t,i.textContent=o,document.getElementById(e).appendChild(i)}loadStartMenu(){let e=document.createElement("img");return e.src="envs/vacuumworld-ts/res/images/start_menu.png",e.alt="Start menu",e}createButton(e,t,o,i){let n=document.createElement("button");return n.textContent=e,n.id=t,o.forEach((e=>n.classList.add(e))),n.addEventListener("click",i),n}startSimulation(){console.log("Start simulation.")}openWiki(){window.open("https://github.com/dicelab-rhul/web-agent/")}setOptions(){this.createOptionsDialog(),this.createSpeedSelector(),this.createAutoplayCheckbox(),this.createStateToLoadUploadInput(),this.createTooltipsCheckbox(),this.createMaxNumberOfCyclesInput(),this.createEffortsSelector(),this.createTeleoraUploadInput();let e=document.getElementById("options_dialog");document.getElementById("options_dialog_ok_button").addEventListener("click",(()=>this.saveOptionsAndCloseDialog(e))),document.getElementById("options_dialog_cancel_button").addEventListener("click",(()=>this.discardOptionsAndCloseDialog(e))),e.showModal(),document.getElementById("options_dialog_div").removeAttribute("hidden")}createSpeedSelector(){this.generateSpeedValues().forEach((e=>{let t=document.createElement("option");t.id="speed_value_"+e.toString(),t.value=e.toString(),t.textContent=e.toString(),document.getElementById("speed_values").appendChild(t)}))}generateSpeedValues(){let e=[];for(let t=0;t<1e3;t++)e.push(t/1e3);return e}createAutoplayCheckbox(){let e=document.createElement("input");e.type="checkbox",e.id="autoplay_checkbox",e.checked=!1,document.getElementById("autoplay_selector_div").appendChild(e)}createStateToLoadUploadInput(){let e=document.createElement("input");e.type="file",e.accept=".json",e.id="state_to_load_upload_input",document.getElementById("state_to_load_selector_div").appendChild(e)}createTooltipsCheckbox(){let e=document.createElement("input");e.type="checkbox",e.id="tooltips_checkbox",e.checked=!0,document.getElementById("tooltips_selector_div").appendChild(e)}createMaxNumberOfCyclesInput(){let e=document.createElement("input");e.type="number",e.id="max_number_of_cycles_input",document.getElementById("max_number_of_cycles_selector_div").appendChild(e)}createEffortsSelector(){this.getActionNames().forEach((e=>this.createEffortSelector(e)))}getActionNames(){return["VWIdleAction","VWMoveAction","VWTurnAction","VWCleanAction","VWDropDirtAction","VWSpeakAction","VWBroadcastAction"]}createEffortSelector(e){let t=document.createElement("div");t.id=e.toLowerCase()+"_effort_div";let o=document.createElement("label");o.textContent=e;let i=document.createElement("input");i.type="number",i.id=e.toLowerCase()+"_effort_input",t.appendChild(o),t.appendChild(i),document.getElementById("efforts_selector_div").appendChild(t)}createTeleoraUploadInput(){let e=document.createElement("input");e.type="file",e.accept=".tel",e.id="teleora_upload_input",document.getElementById("teleora_selector_div").appendChild(e)}saveOptionsAndCloseDialog(e){this.saveOptions(),e.close(),this.resetOptionsDialog(),console.log("Options saved:"),console.log("Speed: "+this.speed),console.log("Autoplay active: "+this.autoplay),console.log("Saved state to load: "+this.stateToLoad),console.log("Tooltips active: "+this.tooltipsActive),console.log("Max number of cycles: "+this.maxNumberOfCycles),console.log("Efforts:"),console.log("- VWIdleAction: "+this.efforts.get("VWIdleAction")),console.log("- VWMoveAction: "+this.efforts.get("VWMoveAction")),console.log("- VWTurnAction: "+this.efforts.get("VWTurnAction")),console.log("- VWCleanAction: "+this.efforts.get("VWCleanAction")),console.log("- VWDropDirtAction: "+this.efforts.get("VWDropDirtAction")),console.log("- VWSpeakAction: "+this.efforts.get("VWSpeakAction")),console.log("- VWBroadcastAction: "+this.efforts.get("VWBroadcastAction")),console.log("Teleora file to load: "+this.teleora)}discardOptionsAndCloseDialog(e){e.close(),this.resetOptionsDialog()}resetOptionsDialog(){document.getElementById("options_dialog_div").removeChild(document.getElementById("options_dialog"))}saveOptions(){this.speed=parseFloat(document.getElementById("speed_values").value),this.autoplay=document.getElementById("autoplay_checkbox").checked,this.stateToLoad=document.getElementById("state_to_load_upload_input").files[0],this.tooltipsActive=document.getElementById("tooltips_checkbox").checked,this.maxNumberOfCycles=this.parseMaxNumberOfCycles(),this.efforts=this.loadEfforts(),this.teleora=document.getElementById("teleora_upload_input").files[0]}parseMaxNumberOfCycles(){const e=document.getElementById("max_number_of_cycles_input").value;return""===e||null==e?void 0:parseInt(e)}loadEfforts(){let e=new Map;for(const t of this.getActionNames()){const o=document.getElementById(t.toLowerCase()+"_effort_input").value;""===o||null==o?e.set(t,d.getEffort(t)):e.set(t,BigInt(parseInt(o)))}return e}}).run()})();